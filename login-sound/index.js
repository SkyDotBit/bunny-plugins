(function(f,_,a,P,R,r,L){"use strict";function S(e,o,t,i,l,u,s){try{var h=e[u](s),d=h.value}catch(x){t(x);return}h.done?o(d):Promise.resolve(d).then(i,l)}function c(e){return function(){var o=this,t=arguments;return new Promise(function(i,l){var u=e.apply(o,t);function s(d){S(u,i,l,s,h,"next",d)}function h(d){S(u,i,l,s,h,"throw",d)}s(void 0)})}}var{FormSwitchRow:T}=r.Forms;function A(){return P.useProxy(a.storage),React.createElement(r.General.ScrollView,{style:{flex:1}},React.createElement(r.Forms.FormSection,{title:"Settings"},React.createElement(r.Forms.FormRow,{label:"Sound URL",leading:React.createElement(r.Forms.FormIcon,{source:R.getAssetIDByName("ic_link")})}),React.createElement(r.Forms.FormInput,{title:"",keyboardType:"url",placeholder:"https://link.to/sound.mp3",value:m.customUrl,onChange:e=>m.customUrl=e,style:{marginTop:-25,marginHorizontal:12}})),React.createElement(T,{label:"Ignore silent mode",value:a.storage.ignoreSilent??!1,onValueChange:e=>{a.storage.ignoreSilent=e},style:{marginBottom:20}}))}function E(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function b(e,o){for(var t=0;t<o.length;t++){var i=o[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function F(e,o,t){return o&&b(e.prototype,o),t&&b(e,t),e}function n(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}var U=L.findByProps("MobileAudioSound").MobileAudioSound,w=function(){function e(o,t,i,l){E(this,e),n(this,"url",void 0),n(this,"usage",void 0),n(this,"volume",void 0),n(this,"onPlay",void 0),n(this,"onStop",void 0),n(this,"onEnd",void 0),n(this,"onLoad",void 0),n(this,"mas",void 0),n(this,"duration",void 0),n(this,"isLoaded",void 0),n(this,"isPlaying",void 0),n(this,"_playTimeout",void 0),this.url=o,this.usage=t,this.volume=i,this.mas=new U(o,{media:"vibing_wumpus",notification:"activity_launch",ring_tone:"call_ringing",voice:"mute"}[t],i,"default"),this.mas.volume=i,this._preloadSound();for(var[u,s]of Object.entries(l??{}))this[u]=s}return F(e,[{key:"ensureSoundGetter",get:function(){return this.mas?._ensureSound||this.mas?.ensureSound}},{key:"_preloadSound",value:function(o){return c(function*(){var{_duration:t}=yield this.ensureSoundGetter.bind(this.mas)();return this.duration=_.ReactNative.Platform.select({ios:t&&t*1e3,default:t}),this.isLoaded=!!t,o||this.onLoad?.(!!t),!!t}).call(this)}},{key:"play",value:function(){return c(function*(){!this.isLoaded&&this.isLoaded!==!1&&(yield this._preloadSound()),this.isLoaded&&(this.mas.volume=this.volume,yield this.mas.play(),this.isPlaying=!0,this.onPlay?.(),clearTimeout(this._playTimeout),this._playTimeout=setTimeout(()=>(this.onEnd?.(),this.stop()),this.duration))}).call(this)}},{key:"stop",value:function(){return c(function*(){this.isLoaded&&(this.mas.stop(),this.isPlaying=!1,this.onStop?.(),clearTimeout(this._playTimeout),yield this._preloadSound(!0))}).call(this)}}]),e}(),{DCDSoundManager:v}=_.ReactNative.NativeModules,m=a.storage,k=m.customUrl?m.customUrl:"https://raw.githubusercontent.com/Rico040/meine-themen/master/sounds/discordo-discord.mp3",g=6969,M=new w("https://raw.githubusercontent.com/Rico040/meine-themen/master/sounds/discordo-discord.mp3","media",1,{onPlay:()=>console.log("Audio started playing"),onStop:()=>console.log("Audio stopped"),onEnd:()=>console.log("Audio finished"),onLoad:e=>console.log("Audio loaded:",e)}),G=()=>new Promise(e=>{console.log("Hi"),a.storage.ignoreSilent??!1?a.storage.customUrl&&(console.log("There is a custom URL"),new w(a.storage.customUrl,"media",1,{onPlay:()=>console.log("Audio started playing"),onStop:()=>console.log("Audio stopped"),onEnd:()=>console.log("Audio finished"),onLoad:o=>console.log("Audio loaded:",o)})):v.prepare(k,"notification",g,(o,t)=>e(t))});function I(){return c(function*(){M.play()})()}function N(){G(),a.storage.ignoreSilent??!1?I():B()}var p=null,y=!1,O=-1;function B(){return c(function*(){y&&(p!=null&&clearTimeout(p),v.stop(g),y=!1),y=!0,yield v.play(g),setTimeout(()=>{y=!1,v.stop(g),p=null},O)})()}var D={onLoad:()=>{N()},settings:A};return f.default=D,f.settings=m,Object.defineProperty(f,"__esModule",{value:!0}),f})({},vendetta.metro.common,vendetta.plugin,vendetta.storage,vendetta.ui.assets,vendetta.ui.components,vendetta.metro);
