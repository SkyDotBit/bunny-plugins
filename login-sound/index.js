(function(f,p,a,A,L,r,T){"use strict";function S(e,o,t,n,l,u,s){try{var m=e[u](s),d=m.value}catch(C){t(C);return}m.done?o(d):Promise.resolve(d).then(n,l)}function c(e){return function(){var o=this,t=arguments;return new Promise(function(n,l){var u=e.apply(o,t);function s(d){S(u,n,l,s,m,"next",d)}function m(d){S(u,n,l,s,m,"throw",d)}s(void 0)})}}var{FormSwitchRow:E}=r.Forms;function F(){return A.useProxy(a.storage),React.createElement(r.General.ScrollView,{style:{flex:1}},React.createElement(r.Forms.FormSection,{title:"Settings"},React.createElement(r.Forms.FormRow,{label:"Sound URL",leading:React.createElement(r.Forms.FormIcon,{source:L.getAssetIDByName("ic_link")})}),React.createElement(r.Forms.FormInput,{title:"",keyboardType:"url",placeholder:"https://link.to/sound.mp3",value:h.customUrl,onChange:e=>h.customUrl=e,style:{marginTop:-25,marginHorizontal:12}})),React.createElement(E,{label:"Ignore silent mode",value:a.storage.ignoreSilent??!1,onValueChange:e=>{a.storage.ignoreSilent=e},style:{marginBottom:20}}))}function U(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function b(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,o,t){return o&&b(e.prototype,o),t&&b(e,t),e}function i(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}var M=T.findByProps("MobileAudioSound").MobileAudioSound,w=function(){function e(o,t,n,l){U(this,e),i(this,"url",void 0),i(this,"usage",void 0),i(this,"volume",void 0),i(this,"onPlay",void 0),i(this,"onStop",void 0),i(this,"onEnd",void 0),i(this,"onLoad",void 0),i(this,"mas",void 0),i(this,"duration",void 0),i(this,"isLoaded",void 0),i(this,"isPlaying",void 0),i(this,"_playTimeout",void 0),this.url=o,this.usage=t,this.volume=n,this.mas=new M(o,{media:"vibing_wumpus",notification:"activity_launch",ring_tone:"call_ringing",voice:"mute"}[t],n,"default"),this.mas.volume=n,this._preloadSound();for(var[u,s]of Object.entries(l??{}))this[u]=s}return k(e,[{key:"ensureSoundGetter",get:function(){return this.mas?._ensureSound||this.mas?.ensureSound}},{key:"_preloadSound",value:function(o){return c(function*(){var{_duration:t}=yield this.ensureSoundGetter.bind(this.mas)();return this.duration=p.ReactNative.Platform.select({ios:t&&t*1e3,default:t}),this.isLoaded=!!t,o||this.onLoad?.(!!t),!!t}).call(this)}},{key:"play",value:function(){return c(function*(){!this.isLoaded&&this.isLoaded!==!1&&(yield this._preloadSound()),this.isLoaded&&(this.mas.volume=this.volume,yield this.mas.play(),this.isPlaying=!0,this.onPlay?.(),clearTimeout(this._playTimeout),this._playTimeout=setTimeout(()=>(this.onEnd?.(),this.stop()),this.duration))}).call(this)}},{key:"stop",value:function(){return c(function*(){this.isLoaded&&(this.mas.stop(),this.isPlaying=!1,this.onStop?.(),clearTimeout(this._playTimeout),yield this._preloadSound(!0))}).call(this)}}]),e}(),{DCDSoundManager:v}=p.ReactNative.NativeModules,h=a.storage,G=h.customUrl?h.customUrl:"https://raw.githubusercontent.com/Rico040/meine-themen/master/sounds/discordo-discord.mp3",g=6970,I=new w("https://raw.githubusercontent.com/Rico040/meine-themen/master/sounds/discordo-discord.mp3","media",1,{onPlay:()=>console.log("Audio started playing"),onStop:()=>console.log("Audio stopped"),onEnd:()=>console.log("Audio finished"),onLoad:e=>console.log("Audio loaded:",e)}),P=()=>new Promise(e=>{console.log("Hi"),a.storage.ignoreSilent??!1?a.storage.customUrl&&(console.log("There is a custom URL"),new w(a.storage.customUrl,"media",1,{onPlay:()=>console.log("Audio started playing"),onStop:()=>console.log("Audio stopped"),onEnd:()=>console.log("Audio finished"),onLoad:o=>console.log("Audio loaded:",o)})):v.prepare(G,"notification",g,(o,t)=>e(t))});function N(){return c(function*(){I.play()})()}function O(){P(),a.storage.ignoreSilent??!1?N():D()}var _=null,y=!1,B=-1;function D(){return c(function*(){y&&(_!=null&&clearTimeout(_),v.stop(g),y=!1),y=!0,yield v.play(g),setTimeout(()=>{y=!1,v.stop(g),_=null},B)})()}var R=!1,x={onLoad:()=>{R||P().then(function(e){R=!0,e.duration,O()})},settings:F};return f.default=x,f.settings=h,Object.defineProperty(f,"__esModule",{value:!0}),f})({},vendetta.metro.common,vendetta.plugin,vendetta.storage,vendetta.ui.assets,vendetta.ui.components,vendetta.metro);
